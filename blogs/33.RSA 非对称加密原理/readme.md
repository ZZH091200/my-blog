# RSA 加密原理

| 步骤 |          说明          | 描述| 备注 |
| :----: | :--------------------: | :--------------------: | :--------------------: |
|   1    |  找出质数  | P 、Q	 | - | 
|   2   | 计算公共模数   | N = P * Q	 | - | 
|   3  |  欧拉函数  |  φ(N) = (P-1)(Q-1)	 | - | 
|   4 |  计算公钥E	  |  1 < E < φ(N) 	 | E的取值必须是整数、E 和 φ(N) 必须是互质数 | 
|   5|  计算私钥D  | 	E * D % φ(N) = 1 | - | 
|   6|   加密	 | 	C ＝ M E mod N | C：密文 M：明文 | 
|   7|  解密	  |  M ＝C D mod N		 | C：密文 M：明文 | 

公钥＝(E , N) 

私钥＝(D, N)

我们只暴露公钥。

# 示例

## 1. 找出质数 P 、Q

``` bash
P = 3  
Q = 11
```

## 2. 计算公共模数

``` bash 
N = P * Q = 3 * 11 = 33

N = 33
```

## 3. 欧拉函数

``` bash 
φ(N) = (P-1)(Q-1) = 2 * 10 = 20

φ(N) = 20
```

## 4. 计算公钥E

``` bash 
1 < E < φ(N)
1 <E < 20
```

E 的取值范围 {3, 7, 9, 11, 13, 17, 19} ，E的取值必须是整数, E 和 φ(N) 必须是互质数 

取最小的值 E =3 ，3 和 φ(N) =20 互为质数，满足条件

## 5. 计算私钥D

``` bash 
E * D % φ(N) = 1
3 * D  % 20 = 1 
D = 7
```

## 6. 公钥加密

> C ＝ ME mod N

``` bash 
M = 2
E = 3
N = 33

C = 2**3 % 33 = 8
```

明文 '2' 经过 RSA 加密后变成了密文 '8'

## 7. 私钥解密

> M ＝CD mod N

``` bash 
C = 8
D = 7
N = 33

M = 8**7 % 33 = 2
```

密文 '8' 经过 RSA 解密后变成了明文 '2'。

# 公钥加密 - 私钥解密流程图

![](https://img2018.cnblogs.com/blog/667853/201905/667853-20190528004116305-632097529.png)

# 私钥加密 - 公钥解密流程图

![](https://img2018.cnblogs.com/blog/667853/201905/667853-20190528004214262-1798691972.png)

# 参考:

[RSA 非对称加密原理（小白也能看懂哦~）](https://www.cnblogs.com/shoshana-kong/p/10934686.html)

---

[我的博客](https://github.com/zhongzihao1996/my-blog/tree/master)

---

END
