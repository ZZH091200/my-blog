# 前言

浏览器垃圾回收机制 GC(Garbage Collecation)：**垃圾收集器会定期（周期性）找出那些不在继续使用的变量，然后释放其内存。**

# JS 回收机制

## 1. 标记清除

> 当变量进入环境时，将变量标记"进入环境"，当变量离开环境时，标记为："离开环境"。某一个时刻，垃圾回收器会过滤掉环境中的变量，以及被环境变量引用的变量，剩下的就是被视为准备回收的变量。IE、Firefox、Opera、Chrome、Safari 的 js 实现使用的都是标记清除的垃圾回收策。

## 2. 引用计数

> 变量的引用次数，被引用一次则加 1，当这个引用计数为 0 时，被视为准备回收的对象。

# 浏览器内存管理

## GC 方案

### 1. 标记内存中的可达值

从根节点出发，遍历所有的对象，能访问到的，标记为可达的，否则为不可达。

### 2. 回收不可达值占据的内存

步骤 1 完成后，清理掉不可达的对象。

### 3. 内存整理

步骤 2 完成后，进行内存碎片整理。

## GC 不足

浏览器进行垃圾回收的时候，会暂停 JavaScript 脚本，等垃圾回收完毕再继续执行其他代码。对于 JS 游戏、动画对连贯性要求比较高的应用，如果暂停时间很长就会造成页面卡顿。

## GC 优化策略

### 1. 分代收集

多回收新生代，少回收老生代。

![](https://upload-images.jianshu.io/upload_images/10390288-a4d30c55a93d15bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 2. 增量收集

将垃圾收集工作分成更小的块，每次处理一部分，多次处理。

![](https://upload-images.jianshu.io/upload_images/10390288-0ee62656ef02497e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 3. 闲时收集

在 CPU 空闲时运行，减少对代码的影响。

# 内存泄露

> 内存泄露是指一块被分配的内存既不能使用，又不能回收，直到浏览器进程结束

常见内存泄漏情况：

- 全局变量
- 闭包
- DOM 元素引用
- 定时器、回调
- 子元素存在引用
- 监听事件没有解绑

# 参考

[前端之浅谈浏览器的垃圾回收机制和内存泄露](https://www.cnblogs.com/yanglongbo/articles/9762359.html)

---

[我的博客](https://github.com/zhongzihao1996/my-blog/tree/master)

---

END
